#!/usr/bin/env node
module.exports=function(e){var a={};function t(r){if(a[r])return a[r].exports;var s=a[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,t),s.l=!0,s.exports}return t.m=e,t.c=a,t.d=function(e,a,r){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="",t(t.s=0)}([function(e,a,t){"use strict";var r=t(1).version,s=t(2),n=t(3),o=n.validateFile,i=n.validateExample;s.version(r).arguments("<filePath>").description("Validate embedded examples in Swagger-JSONs.\nTo validate external examples, use the `-s` and `-e` option.").option("-s, --schema-path <json-path>","JSON-path to schema, to validate the example file against").option("-e, --example-filepath <file-path>","file path to example file, to be validated").action(function(e,a){var t=a.schemaPath,r=a.exampleFilepath,s=null;s=t&&r?i(e,t,r):o(e);!function(e){a=e.statistics,t=["Response schemas with examples found: "+a.responseSchemasWithExamples,"Response examples without schema found: "+a.responseExamplesWithoutSchema,"Total examples found: "+a.responseExamplesTotal].join("\n"),process.stdout.write(t+"\n"),e.valid&&(process.stdout.write("\nNo errors found.\n\n"),process.exit(0));var a,t;process.stdout.write("\nErrors found.\n\n"),process.stderr.write(JSON.stringify(e.errors,null,"    ")),process.exit(1)}(s)}),s.on("--help",function(){console.log("\n\n  Example for external example-file:\n"),console.log("    $ swagger-examples-validator -s $.paths./.get.responses.200.schema -e example.json swagger.json\n\n")}),s.parse(process.argv)},function(e,a){e.exports={name:"swagger-examples-validator",version:"0.5.2",description:"Validates embedded examples in Swagger-JSONs",main:"dist/index.js",bin:{"swagger-examples-validator":"dist/cli.js"},scripts:{build:"npm run build:clean && npm run build:webpack","build:clean":"rimraf dist","build:webpack":"webpack --bail --progress --profile --config ./webpack/config.babel.js",coverage:'rimraf ./coverage && nyc --reporter=lcov --reporter=text -x "dist/**/*" -x "test/**/*.js" npm test',coveralls:"cat ./coverage/lcov.info | coveralls",test:"npm run build && npm run test:mocha","test:mocha":'BABEL_DISABLE_CACHE=1 mocha --require "babel-register" --require "./test/util/setup-tests" --recursive "./test/specs/**/*.js"',release:"npm run build && npm run release:stage-artifacts && standard-version -a","release:stage-artifacts":"git add dist/*"},repository:{type:"git",url:"git+https://github.com/codekie/swagger-examples-validator.git"},keywords:["swagger","json","validate","examples"],author:"Josua Amann",license:"MIT",bugs:{url:"https://github.com/codekie/swagger-examples-validator/issues"},homepage:"https://github.com/codekie/swagger-examples-validator#readme",devDependencies:{"babel-cli":"^6.26.0","babel-core":"^6.26.0","babel-eslint":"^8.2.1","babel-loader":"^7.1.2","babel-plugin-transform-es2015-classes":"^6.24.1","babel-plugin-transform-es2015-parameters":"^6.24.1","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-polyfill":"^6.26.0","babel-preset-es2015":"^6.24.1","babel-preset-es2015-webpack":"6.4.3","babel-register":"^6.26.0",chai:"^4.1.2",coveralls:"^3.0.0",eslint:"^4.17.0","eslint-loader":"^1.9.0","json-loader":"^0.5.7",mocha:"^5.0.1","mocha-lcov-reporter":"^1.3.0",nyc:"^11.4.1",rimraf:"^2.6.2","standard-version":"^4.3.0","uglifyjs-webpack-plugin":"1.1.8",webpack:"^3.11.0"},dependencies:{ajv:"^6.1.1",commander:"^2.14.1","jsonpath-plus":"0.16.0"}}},function(e,a){e.exports=require("commander")},function(e,a,t){"use strict";function r(e){if(Array.isArray(e)){for(var a=0,t=Array(e.length);a<e.length;a++)t[a]=e[a];return t}return Array.from(e)}Object.defineProperty(a,"__esModule",{value:!0});var s=t(4),n=t(5),o=t(6);a.default=c,a.validateFile=function(e){return c(JSON.parse(s.readFileSync(e,"utf-8")))},a.validateExample=function(e,a,t){var r=u({schemaPaths:[a]}),n=d({validator:h(),jsonSchema:JSON.parse(s.readFileSync(e,"utf-8")),pathResponseSchema:a,filePathExample:t,statistics:r});return{valid:!n.length,statistics:r,errors:n}};var i="schema",l="examples",p="$.."+l+".application/json";function c(e){return function(e,a){var t=h(),s=function(e){return e.reduce(function(e,a){var t=function(e){var a=n.toPathArray(e).slice(),t=a.lastIndexOf(l);return a.splice(t,a.length-t,i),n.toPathString(a)}(a);return e[t]=a,e},{})}(e),o=Object.keys(s),p=u({schemaPaths:o}),c={valid:!0,statistics:p};return o.forEach(function(e){var n,o=d({validator:t,jsonSchema:a,pathResponseSchema:e,pathExample:s[e],statistics:p});if(o.length){c.valid=!1;var i=c.errors;i||(i=[],c.errors=i),(n=c.errors).splice.apply(n,[i.length-1,0].concat(r(o)))}}),c}(function(e){return n({json:e,path:p,resultType:"path"})}(e),e)}function u(e){return{responseSchemasWithExamples:e.schemaPaths.length,responseExamplesTotal:0,responseExamplesWithoutSchema:0}}function m(e,a){return n({json:a,path:e,flatten:!0,wrap:!1,resultType:"value"})}function d(e){var a=e.validator,t=e.jsonSchema,o=e.pathResponseSchema,i=e.pathExample,l=e.filePathExample,p=e.statistics,c=[],u=m(o,t),d=l?JSON.parse(s.readFileSync(l,"utf-8")):m(i,t);return p.responseExamplesTotal++,u?a.validate(u,d)?c:c.concat.apply(c,r(a.errors.map(function(e){return i?e.examplePath=n.toPointer(n.toPathArray(i)):e.exampleFilePath=l,e}))):(p.responseSchemasWithExamples--,p.responseExamplesWithoutSchema++,c)}function h(){return new o({allErrors:!0})}},function(e,a){e.exports=require("fs")},function(e,a){e.exports=require("jsonpath-plus")},function(e,a){e.exports=require("ajv")}]);
//# sourceMappingURL=cli.js.map