#!/usr/bin/env node
module.exports=function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";var a=r(1).version,n=r(2),s=r(3),o=s.validateFile,i=s.validateExample,l=s.validateExamplesByMap;n.version(a).arguments("<filepath>").description("Validate embedded examples in Swagger-JSONs.\n  To validate external examples, use the `-s` and `-e` option.\n  To pass a mapping-file, to validate multiple external examples, use the `-m` option.").option("-s, --schema-jsonpath <schema-jsonpath>","JSON-path to schema, to validate the example file against").option("-e, --example-filepath <example-filepath>","file path to example file, to be validated").option("-m, --map-filepath <map-filepath>","file path to map, containing schema-paths as key and the file-path(s) to examples as value").action(function(e,t){var r=t.schemaJsonpath,a=t.exampleFilepath,n=t.mapFilepath,s=null;n?(console.log("Validating with mapping file"),s=l(e,n)):r&&a?(console.log("Validating single external example"),s=i(e,r,a)):(console.log("Validating examples"),s=o(e));!function(e){t=e.statistics,r=t.responseSchemasWithExamples,a=void 0===r?"-":r,n=t.responseExamplesWithoutSchema,s=void 0===n?"-":n,o=t.responseExamplesTotal,i=void 0===o?"-":o,l=["Response schemas with examples found: "+a,"Response examples without schema found: "+s,"Total examples found: "+i].join("\n"),process.stdout.write(l+"\n"),e.valid&&(process.stdout.write("\nNo errors found.\n\n"),process.exit(0));var t,r,a,n,s,o,i,l;process.stdout.write("\nErrors found.\n\n"),process.stderr.write(JSON.stringify(e.errors,null,"    ")),process.exit(1)}(s)}),n.on("--help",function(){console.log("\n\n  Example for external example-file:\n"),console.log("    $ swagger-examples-validator -s $.paths./.get.responses.200.schema -e example.json swagger.json\n\n")}),n.parse(process.argv)},function(e,t){e.exports={name:"swagger-examples-validator",version:"0.6.0",description:"Validates embedded examples in Swagger-JSONs",main:"dist/index.js",bin:{"swagger-examples-validator":"dist/cli.js"},scripts:{build:"npm run build:clean && npm run build:webpack","build:clean":"rimraf dist","build:webpack":"webpack --bail --progress --profile --config ./webpack/config.babel.js",coverage:'rimraf ./coverage && nyc --reporter=lcov --reporter=text -x "dist/**/*" -x "test/**/*.js" npm test',coveralls:"cat ./coverage/lcov.info | coveralls",test:"npm run build && npm run test:mocha","test:mocha":'BABEL_DISABLE_CACHE=1 mocha --require "babel-register" --require "./test/util/setup-tests" --recursive "./test/specs/**/*.js"',release:"npm run build && npm run release:stage-artifacts && standard-version -a","release:stage-artifacts":"git add dist/*"},repository:{type:"git",url:"git+https://github.com/codekie/swagger-examples-validator.git"},keywords:["swagger","json","validate","examples"],author:"Josua Amann",license:"MIT",bugs:{url:"https://github.com/codekie/swagger-examples-validator/issues"},homepage:"https://github.com/codekie/swagger-examples-validator#readme",devDependencies:{"babel-cli":"^6.26.0","babel-core":"^6.26.0","babel-eslint":"^8.2.1","babel-loader":"^7.1.2","babel-plugin-transform-es2015-classes":"^6.24.1","babel-plugin-transform-es2015-parameters":"^6.24.1","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-polyfill":"^6.26.0","babel-preset-es2015":"^6.24.1","babel-preset-es2015-webpack":"6.4.3","babel-register":"^6.26.0",chai:"^4.1.2",coveralls:"^3.0.0",eslint:"^4.17.0","eslint-loader":"^1.9.0","json-loader":"^0.5.7",mocha:"^5.0.1","mocha-lcov-reporter":"^1.3.0",nyc:"^11.4.1",rimraf:"^2.6.2","standard-version":"^4.3.0","uglifyjs-webpack-plugin":"1.1.8",webpack:"^3.11.0"},dependencies:{ajv:"^6.1.1",commander:"^2.14.1",errno:"0.1.7","jsonpath-plus":"0.16.0",lodash:"4.17.5"}}},function(e,t){e.exports=require("commander")},function(e,t,r){"use strict";var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],a=!0,n=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){n=!0,s=e}finally{try{!a&&i.return&&i.return()}finally{if(n)throw s}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var s=r(4),o=r(5),i=r(6),l=r(7),p=r(8).custom.createError,c="schema",u="examples",m="$.."+u+".application/json",d="Validation",f=p("JsonPathNotFound");function h(e){return function(e,t){var r=S(),a=function(e){return e.reduce(function(e,t){var r=function(e){var t=i.toPathArray(e).slice(),r=t.lastIndexOf(u);return t.splice(r,t.length-r,c),i.toPathString(t)}(t);return e[r]=t,e},{})}(e),s=Object.keys(a),o=b({schemaPaths:s}),l={valid:!0,statistics:o,errors:[]};return s.forEach(function(e){var s=l.errors,p=a[e],c=y(p,t),u=j(e,t,!0),m=w({validator:r,responseSchema:u,example:c,statistics:o}).map(function(e){return e.examplePath=i.toPointer(i.toPathArray(p)),e});m.length&&(l.valid=!1,s.splice.apply(s,[s.length-1,0].concat(n(m))))}),l}(function(e){return i({json:e,path:m,resultType:"path"})}(e),e)}function v(e,t){var r=b({schemaPaths:e});return x({errors:t(r),statistics:r})}function g(e){var t=e.code,r=e.message,a=e.path,n=e.cause,o=t||e.type||d,i={type:o,message:r};return d===o?s.merge(i,e):(a&&s.merge(i,{params:{path:a}}),n&&s.merge(i,n)),i}function x(e){var t=e.errors,r=e.statistics,a=void 0===r?{}:r;return{valid:!t.length,statistics:a,errors:t}}function b(e){return{responseSchemasWithExamples:e.schemaPaths.length,responseExamplesTotal:0,responseExamplesWithoutSchema:0}}function y(e,t){return i({json:t,path:e,flatten:!0,wrap:!1,resultType:"value"})}function w(e){var t=e.validator,r=e.responseSchema,a=e.example,s=e.statistics,o=[];return s.responseExamplesTotal++,r?t.validate(r,a)?o:o.concat.apply(o,n(t.errors.map(g))):(s.responseSchemasWithExamples--,s.responseExamplesWithoutSchema++,o)}function S(){return new l({allErrors:!0})}function j(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=y(e,t);if(!r&&!a)throw new f("Path to response-schema can't be found: '"+e+"'",{params:{path:e}});return a}e.exports={default:h,validateFile:function(e){var t=null;try{t=JSON.parse(o.readFileSync(e,"utf-8"))}catch(e){return x({errors:[g(e)]})}return h(t)},validateExample:function(e,t,r){var a=null,n=null,s=null;try{a=JSON.parse(o.readFileSync(r,"utf-8")),s=JSON.parse(o.readFileSync(e,"utf-8")),n=j(t,s)}catch(e){return x({errors:[g(e)]})}return v([t],function(e){return w({validator:S(),responseSchema:n,example:a,statistics:e}).map(function(e){return e.exampleFilePath=r,e})})},validateExamplesByMap:function(e,t){var r=null,n=null;try{r=JSON.parse(o.readFileSync(t,"utf-8")),n=JSON.parse(o.readFileSync(e,"utf-8"))}catch(e){return x({errors:[g(e)]})}return v(Object.keys(r),function(e){return s(r).entries().flatMap(function(r){var i=a(r,2),l=i[0],p=i[1],c=null;try{c=j(l,n)}catch(e){return e.cause.mapFilePath=t,g(e)}return s([p]).flatten().flatMap(function(t){var r=null;try{r=JSON.parse(o.readFileSync(t,"utf-8"))}catch(e){return g(e)}return w({validator:S(),responseSchema:c,example:r,statistics:e}).map(function(e){return e.exampleFilePath=t,e})}).toArray().forEach(function(e){return Object.assign(e,{mapFilePath:t})})}).value()})}}},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("jsonpath-plus")},function(e,t){e.exports=require("ajv")},function(e,t){e.exports=require("errno")}]);
//# sourceMappingURL=cli.js.map