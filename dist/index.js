module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("errno")},function(e,t,r){const n=r(0),a=r(3),s=r(4),o=r(5),c=r(6),i=r(7),u=r(1).custom.createError,l=r(8),p=l.ERR_TYPE__JSON_PATH_NOT_FOUND,f="schema",m="examples",h=`$..${m}.application/json`,d=u(p);function y(e){return function(e,t){const r=b(),n=function(e){return e.reduce((e,t)=>{const r=function(e){const t=c.toPathArray(e).slice(),r=t.lastIndexOf(m);return t.splice(r,t.length-r,f),c.toPathString(t)}(t);return e[r]=t,e},{})}(e),a=Object.keys(n),s=P({schemaPaths:a}),o={valid:!0,statistics:s,errors:[]};return a.forEach(e=>{const a=o.errors,i=n[e],u=g(i,t),l=E(e,t,!0),p=S({validator:r,responseSchema:l,example:u,statistics:s}).map(e=>(e.examplePath=c.toPointer(c.toPathArray(i)),e));p.length&&(o.valid=!1,a.splice(a.length-1,0,...p))}),o}(function(e){return c({json:e,path:h,resultType:"path"})}(e),e)}function x(e,t){const r=P({schemaPaths:e});return O({errors:t(r),statistics:r})}function O({errors:e,statistics:t={}}){return{valid:!e.length,statistics:t,errors:e}}function P({schemaPaths:e}){return{responseSchemasWithExamples:e.length,responseExamplesTotal:0,responseExamplesWithoutSchema:0}}function g(e,t){return c({json:t,path:e,flatten:!0,wrap:!1,resultType:"value"})}function S({validator:e,responseSchema:t,example:r,statistics:n}){const a=[];return n.responseExamplesTotal++,t?e.validate(t,r)?a:a.concat(...e.errors.map(l.create)):(n.responseSchemasWithExamples--,n.responseExamplesWithoutSchema++,a)}function b(){return new i({allErrors:!0})}function E(e,t,r=!1){const n=g(e,t);if(!r&&!n)throw new d(`Path to response-schema can't be found: '${e}'`,{params:{path:e}});return n}e.exports={default:y,validateFile:function(e){let t=null;try{t=JSON.parse(a.readFileSync(e,"utf-8"))}catch(e){return O({errors:[l.create(e)]})}return y(t)},validateExample:function(e,t,r){let n=null,s=null,o=null;try{n=JSON.parse(a.readFileSync(r,"utf-8")),o=JSON.parse(a.readFileSync(e,"utf-8")),s=E(t,o)}catch(e){return O({errors:[l.create(e)]})}return x([t],e=>S({validator:b(),responseSchema:s,example:n,statistics:e}).map(e=>(e.exampleFilePath=r,e)))},validateExamplesByMap:function(e,t,{cwdToMappingFile:r}={}){let c=0;const i=o.sync(t,{nonull:!0}).map(t=>{let o=null,i=null;try{o=JSON.parse(a.readFileSync(t,"utf-8")),i=JSON.parse(a.readFileSync(e,"utf-8"))}catch(e){return O({errors:[l.create(e)]})}return c++,x(Object.keys(o),e=>(function(e,t,r,{cwdToMappingFile:o=!1,dirPathMapExternalExamples:c}){return n(t).entries().flatMap(([t,i])=>{let u=null;try{u=E(t,e)}catch(e){return l.create(e)}return n([i]).flatten().flatMap(e=>{let t=null;try{const r=o?s.join(c,e):e;t=JSON.parse(a.readFileSync(r,"utf-8"))}catch(e){return l.create(e)}return S({validator:b(),responseSchema:u,example:t,statistics:r}).map(t=>(t.exampleFilePath=e,t))}).value()}).value()})(i,o,e,{cwdToMappingFile:r,dirPathMapExternalExamples:s.dirname(t)}).map(e=>Object.assign(e,{mapFilePath:t})))});return n.merge(i.reduce((e,t)=>e?function(e,t){return O({errors:e.errors.concat(t.errors),statistics:n.entries(e.statistics).reduce((e,[r,n])=>(e[r]=n+t.statistics[r],e),P({schemaPaths:[]}))})}(e,t):t,null),{statistics:{matchingFilePathsMapping:c}})}}},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("glob")},function(e,t){e.exports=require("jsonpath-plus")},function(e,t){e.exports=require("ajv")},function(e,t,r){function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const a=r(0),s=r(1).code.ENOENT;class o{static create(e){const t=o.ERR_TYPE__VALIDATION,r=e.code,n=e.message,s=e.path,c=e.cause,i=r||e.type||t,u={message:n};return t===i?a.merge(u,e):(s&&a.merge(u,{params:{path:s}}),c&&a.merge(u,c)),new o(i,u)}constructor(e,t={}){Object.assign(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){n(e,t,r[t])})}return e}({type:e},t))}}e.exports=o,o.ERR_TYPE__VALIDATION="Validation",o.ERR_TYPE__JSON_PATH_NOT_FOUND="JsonPathNotFound",o.ERR_TYPE__JS_ENOENT=s.code}]);
//# sourceMappingURL=index.js.map